<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Wet Lab Protocol | iGEM Wiki</title>
<link rel="stylesheet" href="../css/styles_main.css"/>
<link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />
<script src="https://cdn.tailwindcss.com"></script>
<base href="/"/>

<style>
html {
    scroll-behavior: smooth;
    scroll-padding-top: 80px; /* Offset for sticky navbar */
}

/* === LAYOUT & CONTENT STYLES === */
body {
    background-color: #ffffff;
}

.docs-layout {
    display: flex;
    flex-direction: row;
    max-width: 1400px;
    margin: 0 auto;
    padding: 2rem 2rem 4rem;
}

.docs-sidebar {
    position: sticky;
    top: 80px; /* Adjusted for navbar height */
    width: 256px;
    height: calc(100vh - 120px);
    flex-shrink: 0;
    overflow-y: auto;
    padding-right: 1.5rem;
}

.docs-sidebar nav a {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 8px 12px;
    border-radius: 6px;
    color: #4b5563;
    transition: all 0.2s ease;
    font-size: 0.9rem;
    font-weight: 500;
}

.docs-sidebar nav a:hover {
    background-color: #f3f4f6;
    color: #1f2937;
}

/* This is the class for the main section link highlight */
.active-section-link {
    background-color: #eef2ff;
    color: #4338ca;
    font-weight: 600;
}

/* This is for the specific subsection link */
.active-subsection-link {
    color: #4338ca;
    font-weight: 600;
}


.sub-list {
    padding-left: 12px;
    margin-left: 8px;
    border-left: 1px solid #e5e7eb;
    overflow: hidden;
    max-height: 1000px; /* Should be large enough to not clip content */
    transition: max-height 0.4s ease-in-out;
}

.sub-list.collapsed { max-height: 0; }

.collapse-icon {
    transition: transform 0.3s ease;
    width: 1rem;
    height: 1rem;
    color: #9ca3af;
}

a[aria-expanded="false"] .collapse-icon { transform: rotate(-90deg); }

/* Main Content Typography */
main {
    flex-grow: 1;
    min-width: 0;
}

main article h1 { font-size: 2.25rem; font-weight: 800; color: #111827; }
main article .lead { font-size: 1.125rem; color: #4b5563; margin-top: 0.5rem; border-bottom: 1px solid #e5e7eb; padding-bottom: 1.5rem; }
main article h2 { font-size: 1.5rem; font-weight: 700; color: #111827; margin-top: 2.5rem; margin-bottom: 1rem; }
main article h3 { font-size: 1.25rem; font-weight: 600; color: #1f2937; margin-top: 2rem; margin-bottom: 0.75rem; }
main article h4 { font-size: 1.1rem; font-weight: 600; color: #374151; margin-top: 1.5rem; margin-bottom: 0.5rem; }
main article p { font-size: 1rem; line-height: 1.75rem; color: #374151; margin-bottom: 1rem; }
main article pre { background-color: #1f2937; color: #d1d5db; padding: 1rem; margin: 1.25rem 0 1.5rem; border-radius: 0.5rem; overflow-x: auto; font-size: 0.875rem; }

/* === STANDARDIZED CALLOUT BLOCKS === */
.callout {
    padding: 1rem;
    margin: 1.25rem 0;
    border-radius: 0.5rem;
    border-left-width: 4px;
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}
.callout-header {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-weight: 600;
}
.callout-header svg {
    width: 1.25rem;
    height: 1.25rem;
    flex-shrink: 0;
}
.callout p {
    margin: 0;
    font-size: 0.95rem;
    line-height: 1.6;
}

/* Note Style (Blue) */
.callout-note { background-color: #eff6ff; border-color: #3b82f6; }
.callout-note .callout-header { color: #1e40af; }
.callout-note p { color: #1c3d8e; }

/* Caution Style (Yellow) */
.callout-caution { background-color: #fefce8; border-color: #f59e0b; }
.callout-caution .callout-header { color: #854d0e; }
.callout-caution p { color: #85560e; }

/* Trivia Style (Green) */
.callout-trivia { background-color: #f0fdf4; border-color: #22c55e; }
.callout-trivia .callout-header { color: #15803d; }
.callout-trivia p { color: #166534; }


/* Responsive adjustments */
@media (max-width: 1024px) {
    .docs-sidebar { display: none; }
}
</style>

<style>

    #progress-bar {
  position: fixed;
  top: 0;
  left: 0;
  height: 4px;
  background: linear-gradient(to right, #b859dd, #7a40d1);
  width: 0%;
  z-index: 2000;
}

    /* Underline effect for links in the article */
/* Background highlight effect for links in the article */
main article a {
    color: #b859dd; /* Makes links stand out with the theme color */
    font-weight: 500;
    text-decoration: none;
    background-color: transparent; /* Start with no background */
    padding: 2px 6px; /* Adds space around the text for the background */
    margin: -2px -6px; /* Prevents padding from affecting line spacing */
    border-radius: 6px; /* Gives the background rounded corners */
    transition: all 0.2s ease-in-out;
}

main article a:hover,
main article a:focus {
    background-color: #eef2ff; /* The same light purple as the active sidebar link */
    color: #7a40d1; /* A slightly darker purple for better contrast on hover */
}

    /* Custom Scrollbar for Webkit browsers (Chrome, Safari) */
.docs-sidebar::-webkit-scrollbar {
    width: 8px;
}
.docs-sidebar::-webkit-scrollbar-track {
    background: #f1f5f9;
    border-radius: 10px;
}
.docs-sidebar::-webkit-scrollbar-thumb {
    background: #cbd5e1;
    border-radius: 10px;
}
.docs-sidebar::-webkit-scrollbar-thumb:hover {
    background: #94a3b8;
}

/* Code Block Styling */
main article pre {
    position: relative; /* Needed for the copy button */
    padding-top: 2.5rem; /* Make space for header */
}

.code-header {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    display: flex;
    justify-content: space-between;
    align-items: center;
    background-color: #374151; /* A slightly lighter shade */
    color: #9ca3af;
    padding: 0.5rem 1rem;
    font-size: 0.8rem;
    border-top-left-radius: 0.5rem;
    border-top-right-radius: 0.5rem;
}

.copy-button {
    background-color: transparent;
    color: #9ca3af;
    border: none;
    padding: 0.25rem 0.5rem;
    border-radius: 4px;
    cursor: pointer;
    transition: all 0.2s ease;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.copy-button:hover {
    background-color: #4b5563;
    color: #e5e7eb;
}
</style>

<style>
    /* Premium Navbar */
    .navbar-1 {
    position: sticky;
    top: 0;
    background: rgba(255, 255, 255, 0.8);
    backdrop-filter: saturate(180%) blur(20px);
    border-bottom: 0.5px solid rgba(0, 0, 0, 0.1);
    z-index: 1000;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .navbar-1 .container {
    max-width: 1400px;
    margin: 0 auto;
    padding: 0 2rem;
    display: flex;
    align-items: center;
    justify-content: space-between;
    height: 64px;
    }


    /* Main Navigation */
    .nav-menu {
    display: flex;
    list-style: none;
    align-items: center;
    gap: 8px;
    }

    .nav-menu > li {
    position: relative;
    }

    .nav-menu > li > a {
    display: flex;
    align-items: center;
    padding: 8px 16px;
    color: #1c1f28;
    text-decoration: none;
    font-weight: 500;
    font-size: 0.95rem;
    border-radius: 8px;
    transition: all 0.2s ease;
    position: relative;
    font-weight: bold;
    }

    .nav-menu > li > a:hover {
    background: rgba(0, 0, 0, 0.05);
    color: #ca74ec;
    }

    /* macOS-style Dropdown */
    .navbar-2 {
    position: absolute;
    top: calc(100% + 8px);
    left: 50%;
    transform: translateX(-50%);
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: saturate(180%) blur(20px);
    border: 0.5px solid rgba(0, 0, 0, 0.1);
    border-radius: 12px;
    box-shadow: 
        0 8px 32px rgba(0, 0, 0, 0.12),
        0 2px 8px rgba(0, 0, 0, 0.08),
        inset 0 1px 0 rgba(255, 255, 255, 0.5);
    opacity: 0;
    visibility: hidden;
    transform: translateX(-50%) translateY(-8px) scale(0.95);
    transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
    min-width: 180px;
    padding: 8px;
    }

    .navbar-2::before {
    content: '';
    position: absolute;
    top: -4px;
    left: 50%;
    transform: translateX(-50%);
    width: 0;
    height: 0;
    border-left: 6px solid transparent;
    border-right: 6px solid transparent;
    border-bottom: 4px solid rgba(255, 255, 255, 0.95);
    filter: drop-shadow(0 -1px 1px rgba(0, 0, 0, 0.1));
    }

    .nav-menu > li:hover .navbar-2 {
    opacity: 1;
    visibility: visible;
    transform: translateX(-50%) translateY(0) scale(1);
    }

    .navbar-2 .container {
    padding: 0;
    height: auto;
    display: block;
    }

    .nav-menu_hovered {
    list-style: none;
    display: flex;
    flex-direction: column;
    gap: 2px;
    }

    .nav-menu_hovered a {
    display: block;
    padding: 8px 12px;
    color: #1c1f28;
    text-decoration: none;
    font-weight: 400;
    font-size: 0.9rem;
    border-radius: 6px;
    transition: all 0.15s ease;
    position: relative;
    }

    .nav-menu_hovered a:hover {
    background: #ca74ec;
    color: white;
    transform: translateX(2px);
    }
    /* Mobile Responsive */
    @media (max-width: 768px) {
    .navbar-1 .container {
        height: 60px;
        padding: 0 1rem;
        justify-content: space-between; /* logo left, toggle right */
    }

    .nav-menu {
        max-height: 0;                /* hidden by default */
        overflow: hidden;
        position: absolute;
        top: 100%;
        left: 0;
        right: 0;
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: saturate(180%) blur(20px);
        border: 0.5px solid rgba(0, 0, 0, 0.1);
        border-radius: 0 0 16px 16px;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.12);
        padding: 0 1rem;
        flex-direction: column;
        gap: 0;
        z-index: 999;
        transition: max-height 0.4s ease; /* smooth slide */
    }

    .nav-menu.open {
        max-height: 600px; /* enough space for all links */
        padding: 1rem;
    }

    .nav-menu > li {
        width: 100%;
    }

    .nav-menu > li > a {
        padding: 12px 16px;
        border-radius: 8px;
        justify-content: space-between;
    }

    .navbar-2 {
        position: static;
        transform: none;
        opacity: 1;
        visibility: visible;
        background: rgba(248, 249, 250, 0.8);
        backdrop-filter: none;
        border: none;
        border-radius: 8px;
        box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1);
        margin-top: 8px;
        padding: 8px;
    }

    .navbar-2::before {
        display: none;
    }

    .hero-title {
        font-size: 2rem;
    }

    .hero-text {
        padding: 2rem 1.5rem;
    }
    }

    /* Default (desktop) — hidden */
    .nav-toggle {
    display: none;
    border: none;
    background: transparent;
    cursor: pointer;
    padding: 0.5rem;
    justify-content: center;
    align-items: center;
    }

    /* Show only on mobile */
    @media (max-width: 768px) {
    .nav-toggle {
        display: flex;
    }
    }

    /* Hamburger icon (3 bars) */
    .nav-toggle-icon {
    position: relative;
    width: 28px;
    height: 3px;
    background-color: #333;
    display: block;
    transition: background-color 0.2s ease-in-out;
    }

    .nav-toggle-icon::before,
    .nav-toggle-icon::after {
    content: '';
    position: absolute;
    width: 28px;
    height: 3px;
    background-color: #333;
    transition: transform 0.2s ease-in-out, top 0.2s ease-in-out;
    }

    .nav-toggle-icon::before {
    top: -8px;
    }

    .nav-toggle-icon::after {
    top: 8px;
    }

    /* Expanded (turn into X) */
    .nav-toggle[aria-expanded="true"] .nav-toggle-icon {
    background-color: transparent;
    }

    .nav-toggle[aria-expanded="true"] .nav-toggle-icon::before {
    transform: rotate(45deg);
    top: 0;
    }

    .nav-toggle[aria-expanded="true"] .nav-toggle-icon::after {
    transform: rotate(-45deg);
    top: 0;
    }


    /* Logo */
    .navbar-brand {
    margin-top: 1px;
    display: flex;
    align-items: center;
    gap: 12px;
    font-size: 1.6rem;
    font-weight: 600;
    letter-spacing: -0.3px;
    top: 60px;
    }

    .navbar-brand img {
    height: 60px;
    width: auto;
    transition: transform 0.2s ease;
    }

    .navbar-brand:hover img {
    transform: scale(1.05);
    }
</style>

</head>
<body class="bg-white">

<div id="progress-bar"></div>

<!-- Navbar -->
  <nav class="navbar-1">
    <div class="container">
      <!-- Logo -->
      <a class="navbar-brand" href="/main.html">
        <img src="images/igemlogo.png" alt="Site Logo"/>
      </a>

      <!-- Mobile toggle -->
      <button class="nav-toggle" id="nav-toggle" aria-label="Toggle menu" aria-expanded="false">
        <span class="nav-toggle-icon"></span>
      </button>

      <!-- Main Nav -->
      <ul class="nav-menu" id="nav-menu">
        <li>
          <a href="../project.html">Project</a>
          <nav class="navbar-2">
            <div class="container">
              <ul class="nav-menu_hovered">
                <li><a href="../project/ideation.html">Ideation</a></li>
                <li><a href="../project/overview.html">Overview</a></li>
              </ul>
            </div>
          </nav>
        </li>

        <li>
          <a href="/wetlab.html">Wet Lab</a>
          <nav class="navbar-2">
            <div class="container">
              <ul class="nav-menu_hovered">
                <li><a href="/wetlab/design.html">Design</a></li>
                <li><a href="/wetlab/engineering.html">Engineering</a></li>
                <li><a href="/wetlab/experimentation.html">Experimentation</a></li>
                <li><a href="/wetlab/notebook.html">Notebook</a></li>
                <li><a href="/wetlab/parts.html">Parts</a></li>
                <li><a href="/wetlab/delivery.html">Delivery Mechanisms</a></li>
                <li><a href="/wetlab/biosafety.html">Biosafety and Biosecurity</a></li>
              </ul>
            </div>
          </nav>
        </li>

        <li>
          <a href="../drylab.html">Dry Lab</a>
          <nav class="navbar-2">
            <div class="container">
              <ul class="nav-menu_hovered">
                <li><a href="../drylab/engineering.html">Engineering</a></li>
                <li><a href="../drylab/ml.html">ML Modelling</a></li>
                <li><a href="../drylab/modelling.html">ODE Modelling</a></li>
                <li><a href="../drylab/juniors.html">Improvised GenBank</a></li>
                <li><a href="../drylab/alphafold.html">Alphafold</a></li>
              </ul>
            </div>
          </nav>
        </li>

        <li>
          <a href="../hp.html">Human Practices</a>
          <nav class="navbar-2">
            <div class="container">
              <ul class="nav-menu_hovered">
                <li><a href="../hp/ihp.html">Integrated Human Practices</a></li>
                <li><a href="../hp/results.html">Results and Analysis</a></li>
                <li><a href="../hp/sustainable.html">Sustainable Development</a></li>
                <li><a href="../hp/blogs.html">Blogs</a></li>
              </ul>
            </div>
          </nav>
        </li>

        <li>
          <a href="../team.html">Team</a>
          <nav class="navbar-2">
            <div class="container">
              <ul class="nav-menu_hovered">
                <li><a href="../team/attributions.html">Atttributions</a></li>
                <li><a href="../team/gallery.html">Gallery</a></li>
                <li><a href="../team/aiim.html">AIIM</a></li>
              </ul>
            </div>
          </nav>
        </li>

      </ul>
    </div>
  </nav>

<div class="docs-layout">
    <aside class="docs-sidebar">
        <nav id="docs-nav" class="w-full"></nav>
    </aside>

    <main class="lg:pl-8">
        <article>
            <header id="top">
                <h1>Biosafety and Biosecurity</h1>
                <p class="lead">Ensuring safety and security in our synthetic biology endeavors</p>
            </header>

            <section id="biosafety" data-aos="fade-up">
                <h2>Biosafety and Biosecurity</h2>
                <p>Our venture into biosafety and biosecurity began quite early in the ideation cycle, but made its first significant strides after the iGEM ambassadors’ biosafety, biosecurity, and dual-use research concerns (DURC) workshop at the All-India iGEM Meet (AIIM). </p>
                <p>According to the USA National Research Council, biosafety is about protecting people from ‘bad bugs’, and biosecurity is about protecting bugs from ‘bad people’. To put it more formally, biosafety is concerned with preventing accidental exposure to and release of biological materials, while biosecurity deals with preventing the intentional and malicious misuse of biological materials.</p>
                <p>Any synthetic biology project has the possibility of falling victim to either or both situations and facing the consequences thereof. Therefore, we have taken concrete steps towards ensuring we cover the predictable dark paths our project might venture into. </p>
            </section>

            <section id="lab-safety" data-aos="fade-up">
                <h2>Laboratory Safety and Preparation</h2>
                <p>The lab training we have received as part of our curriculum will enable us to conduct ourselves and our experiments with maximum care and discipline. The lab space we have access to is a fully functional biology laboratory, with sterilization equipment, PPE, safety showers, fume hoods, and laminar air-flow chambers.</p>
                <p>The Office of Laboratory Safety and Environmental Health (OLSEH) is the governing body concerned with laboratory risk management and mitigation at IISc. They have pre-set Incident and Investigation report forms, and also handle laboratory waste disposal for the Institute. Furthermore, as part of our Institute’s policy, all our wet lab team members have taken the online OLSEH safety test to ensure readiness to work inside the laboratory. The training material relevant to us in the safety test covers the following modules:</p>
                <ul>
                    <li>General Safety: This module is mandatory for all.</li>
                    <li>Chemical Safety: Required for all those who plan to work with chemicals (NFPA rating > 1).</li>
                    <li>Biological Safety: Required for all who plan to work in bio-labs.</li>
                <p>Finally, waste disposal at our lab is handled by experts at OLSEH, with properly segregated disposal systems for different materials.</p>
            </section>

            <section id="kill-switch" data-aos="fade-up">
                <h2>Kill Switch</h2>
                <p>Experimentally, we do not have an engineered bacterial kill switch in the conventional sense of the word. Instead, the genes we insert into the bacterium will only get expressed to form nitrite-reducing enzymes when in the presence of sufficient concentrations of benzoate (a plant root exudate). We have done this by using the XylS/Pm inducible promoter-containing plasmid. This ensures that the bacterium only expresses the genes when it is present in the intended environment, which is a biofilm around plant roots. When the bacteria are not in the presence of benzoate—meaning when they are not around plant roots—they will not metabolize nitrate. </p>
                <p>However, they will not die. </p>
                <p>Theoretically, they may spread uncontained while having the exact genetic makeup of wild-type Pseudomonas putida KT2440. Since Pseudomonas putida KT2440 is a well-studied native soil bacterium, mutation permitting, the environment should not be harmed even with its spread.</p>
                <p>This, despite not being a kill switch in the conventional sense, will not allow the modified bacteria to proliferate in an environment where it is not supposed to. We understand that this might not be an effective strategy when translated outside the laboratory, particularly when we consider environmental deployment.</p>
            </section>

            <section>
                <h2>GMO Policy cum Handbook</h2>
                <p>During the judging sessions at AIIM, we spoke at length with Dr. Lavanya Bhagavatula regarding Genetically Modified Organisms (GMOs) and their governing policies in India. Currently, there are a multitude of governmental bodies and departments with heaps. </p>
            </section>
        </article>
    </main>
</div>

<script src="https://unpkg.com/aos@next/dist/aos.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function () {

    // --- FEATURE 1: PROGRESS BAR ---
    window.addEventListener("scroll", () => {
        const docHeight = document.documentElement.scrollHeight - window.innerHeight;
        const scrolled = (window.scrollY / docHeight) * 100;
        const progressBar = document.getElementById("progress-bar");
        if (progressBar) {
            progressBar.style.width = scrolled + "%";
        }
    });

    // --- FEATURE 2: CODE BLOCK COPY BUTTON ---
    document.querySelectorAll('main article pre').forEach(block => {
        const code = block.querySelector('code');
        if (!code) return; // Skip if no <code> tag found
        
        const header = document.createElement('div');
        header.className = 'code-header';
        const title = document.createElement('span');
        title.textContent = 'Protocol';
        const copyButton = document.createElement('button');
        copyButton.className = 'copy-button';
        copyButton.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/><path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3z"/></svg> <span>Copy</span>`;
        
        header.appendChild(title);
        header.appendChild(copyButton);
        block.prepend(header);

        copyButton.addEventListener('click', () => {
            navigator.clipboard.writeText(code.innerText).then(() => {
                copyButton.innerHTML = `<span>Copied!</span>`;
                setTimeout(() => {
                    copyButton.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/><path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5-.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3z"/></svg> <span>Copy</span>`;
                }, 2000);
            });
        });
    });
    // --- FEATURE 3: DYNAMIC SIDEBAR & SCROLLSPY ---
    const navStructure = [
        { id: 'biosafety', title: 'Biosafety and Biosecurity' },
        { id: 'lab-safety', title: 'Laboratory Safety and Preparation' },
        { id: 'kill-switch', title: 'Kill Switch' },
        { id: 'gmo-policy', title: 'GMO Policy cum Handbook' }
    ];

    const navContainer = document.getElementById('docs-nav');
    function createNav(items, isSubList = false) {
        const list = document.createElement('ul');
        list.className = isSubList ? 'sub-list collapsed' : 'space-y-1 mt-4';
        items.forEach(item => {
            const listItem = document.createElement('li');
            const link = document.createElement('a');
            link.href = `#${item.id}`;
            if (item.children) {
                const subListId = `sublist-${item.id}`;
                link.setAttribute('data-toggle', 'collapse');
                link.setAttribute('aria-expanded', 'false');
                link.setAttribute('aria-controls', subListId);
                link.innerHTML = `<span>${item.title}</span><svg class="collapse-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5" /></svg>`;
                listItem.appendChild(link);
                const subList = createNav(item.children, true);
                subList.id = subListId;
                listItem.appendChild(subList);
            } else {
                link.textContent = item.title;
                listItem.appendChild(link);
            }
            list.appendChild(listItem);
        });
        return list;
    }
    const mainNavList = createNav(navStructure);
    const title = document.createElement('h2');
    title.className = 'text-lg font-bold text-gray-900';
    title.textContent = 'Protocol Sections';
    navContainer.appendChild(title);
    navContainer.appendChild(mainNavList);
    
    document.querySelectorAll('.docs-sidebar nav a[data-toggle]').forEach(toggle => {
        toggle.addEventListener('click', e => {
            e.preventDefault();
            const targetElement = document.getElementById(toggle.getAttribute('aria-controls'));
            const isCollapsed = targetElement.classList.toggle('collapsed');
            toggle.setAttribute('aria-expanded', !isCollapsed);
        });
    });

    const allLinks = document.querySelectorAll('.docs-sidebar nav a');
    const sections = document.querySelectorAll("main section, main h3, main h4");
    const observer = new IntersectionObserver(entries => {
        let topmostVisibleEntry = null;
        for (const entry of entries) {
            if (entry.isIntersecting && (!topmostVisibleEntry || entry.boundingClientRect.top < topmostVisibleEntry.boundingClientRect.top)) {
                topmostVisibleEntry = entry;
            }
        }
        if (topmostVisibleEntry) {
            const parentSection = topmostVisibleEntry.target.closest('section');
            if (parentSection) {
                const specificLink = document.querySelector(`.docs-sidebar nav a[href="#${topmostVisibleEntry.target.id}"]`);
                document.querySelectorAll('.sub-list').forEach(sublist => {
                    if (!sublist.contains(specificLink)) {
                        sublist.classList.add('collapsed');
                        const toggle = document.querySelector(`[aria-controls="${sublist.id}"]`);
                        if (toggle) toggle.setAttribute('aria-expanded', 'false');
                    }
                });
                allLinks.forEach(l => l.classList.remove('active-section-link', 'active-subsection-link'));
                const mainLink = document.querySelector(`.docs-sidebar nav a[href="#${parentSection.id}"]`);
                if (mainLink) mainLink.classList.add('active-section-link');
                if (specificLink && specificLink !== mainLink) specificLink.classList.add('active-subsection-link');
                let parent = specificLink ? specificLink.closest('.sub-list') : null;
                while (parent) {
                    if (parent.classList.contains('collapsed')) {
                        parent.classList.remove('collapsed');
                        const parentToggle = document.querySelector(`[aria-controls="${parent.id}"]`);
                        if (parentToggle) parentToggle.setAttribute('aria-expanded', 'true');
                    }
                    parent = parent.parentElement.closest('.sub-list');
                }
            }
        }
    }, { rootMargin: "-40% 0px -59% 0px", threshold: [0, 1] });
    sections.forEach(section => { if (section.id) observer.observe(section); });

    // --- FEATURE 4: INITIALIZE ANIMATE ON SCROLL ---
    AOS.init({
        duration: 600,
        once: true,
        offset: 50,
    });

});
</script>

</body>
</html>
